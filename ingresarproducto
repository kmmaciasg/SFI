<?php
// Conectar a la base de datos
  $conexion = mysqli_connect ("localhost", "root", "", "lachila" ); 

// Verificar si hubo error en la conexión
if (mysqli_connect_errno()) {
  echo "Error en la conexión a la base de datos: " . mysqli_connect_error();
  exit();
}

// Obtener los valores enviados por el usuario
$nombreProducto = $_POST["nombre_producto"];
$unidades = $_POST["unidades"];

// Obtener la cantidad actual del producto desde la base de datos
$consulta = "SELECT cantidad FROM inventario WHERE nombre_producto = '$nombreProducto'";
$resultado = mysqli_query($conexion, $consulta);

// Verificar si hubo error en la consulta
if (!$resultado) {
  echo "Error en la consulta a la base de datos: " . mysqli_error($conexion);
  mysqli_close($conexion);
  exit();
}

// Obtener el resultado de la consulta
$fila = mysqli_fetch_array($resultado);
$cantidadActual = $fila["cantidad"];

// Calcular la nueva cantidad sumando las unidades ingresadas y las actuales
$nuevaCantidad = $cantidadActual + $unidades;

// Actualizar la cantidad en la base de datos
$consulta = "UPDATE inventario SET cantidad = '$nuevaCantidad' WHERE nombre_producto = '$nombreProducto'";
$resultado = mysqli_query($conexion, $consulta);

// Verificar si hubo error en la consulta
if (!$resultado) {
  echo "Error en la consulta a la base de datos: " . mysqli_error($conexion);
  mysqli_close($conexion);
  exit();
}

// Cerrar la conexión a la base de datos
mysqli_close($conexion);

// Mostrar un mensaje con la nueva cantidad
echo "La nueva cantidad de " . $nombreProducto . " es: " . $nuevaCantidad;
?>
